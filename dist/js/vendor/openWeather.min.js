/*!

Name: Open Weather
Dependencies: jQuery, OpenWeatherMap API
Author: Michael Lynch
Author URL: http://michaelynch.com
Date Created: August 28, 2013
Licensed under the MIT license

*/
;(function(a){a.fn.openWeather=function(b){if(!this.length){return this}var f={descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,units:"c",city:null,lat:null,lng:null,key:null,lang:"en",success:function(){},error:function(i){}};var e=this;var d=a(this);var g;e.settings={};e.settings=a.extend({},f,b);var c=e.settings;g="http://api.openweathermap.org/data/2.5/weather?lang="+c.lang;if(c.city!=null){g+="&q="+c.city.replace(" ","")}else{if(c.lat!=null&&c.lng!=null){g+="&lat="+c.lat+"&lon="+c.lng}}if(c.key!=null){g+="&APPID="+c.key}var h=function(n){var k=n*1000;var j=new Date(k);var i=j.getHours();if(i>12){hoursRemaining=24-i;i=12-hoursRemaining}var l=j.getMinutes();l=l.toString();if(l.length<2){l=0+l}var m=i+":"+l;return m};a.ajax({type:"GET",url:g,dataType:"jsonp",success:function(j){if(c.units=="f"){var o=Math.round(((j.main.temp-273.15)*1.8)+32)+"°F";var k=Math.round(((j.main.temp_min-273.15)*1.8)+32)+"°F";var p=Math.round(((j.main.temp_max-273.15)*1.8)+32)+"°F"}else{var o=Math.round(j.main.temp-273.15)+"°C";var k=Math.round(j.main.temp_min-273.15)+"°C";var p=Math.round(j.main.temp_max-273.15)+"°C"}d.html(o);if(c.minTemperatureTarget!=null){a(c.minTemperatureTarget).text(k)}if(c.maxTemperatureTarget!=null){a(c.maxTemperatureTarget).text(p)}a(c.descriptionTarget).text(j.weather[0].description);if(c.iconTarget!=null&&j.weather[0].icon!=null){if(c.customIcons!=null){var q=j.weather[0].icon;var n;var r;if(q.indexOf("d")!=-1){r="day"}else{r="night"}if(q=="01d"||q=="01n"){n="clear"}if(q=="02d"||q=="02n"||q=="03d"||q=="03n"||q=="04d"||q=="04n"){n="clouds"}if(q=="09d"||q=="09n"||q=="10d"||q=="10n"){n="rain"}if(q=="11d"||q=="11n"){n="storm"}if(q=="13d"||q=="13n"){n="snow"}if(q=="50d"||q=="50n"){n="mist"}var m=c.customIcons+r+"/"+n+".png"}else{var m="http://openweathermap.org/img/w/"+j.weather[0].icon+".png"}a(c.iconTarget).attr("src",m)}if(c.placeTarget!=null){a(c.placeTarget).text(j.name+", "+j.sys.country)}if(c.windSpeedTarget!=null){a(c.windSpeedTarget).text(Math.round(j.wind.speed)+" Mph")}if(c.humidityTarget!=null){a(c.humidityTarget).text(j.main.humidity+"%")}if(c.sunriseTarget!=null){var l=h(j.sys.sunrise);a(c.sunriseTarget).text(l+" AM")}if(c.sunsetTarget!=null){var i=h(j.sys.sunset);a(c.sunsetTarget).text(i+" PM")}c.success.call(this)},error:function(i,k,j){c.error.call(this,k)}})}})(jQuery);